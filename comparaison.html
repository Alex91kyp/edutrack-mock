<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparaison anonymisée - EduTrack AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; height: 400px; }
    </style>
</head>
<body class="bg-gray-50 flex h-screen">
    <!-- Sidebar -->
    <div class="hidden md:flex md:w-64 md:flex-col">
        <div class="flex flex-col flex-grow pt-5 bg-white border-r border-gray-200 shadow-sm">
            <!-- Logo -->
            <div class="flex items-center flex-shrink-0 px-6">
                <div class="w-8 h-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center">
                    <i data-feather="brain" class="w-5 h-5 text-white"></i>
                </div>
                <span class="ml-3 text-lg font-semibold text-gray-800">EduTrack AI</span>
            </div>
            
            <!-- User Info -->
            <div class="px-6 mt-6">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                        <i data-feather="user" class="w-6 h-6 text-blue-600"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-gray-800">M. Lefèvre</p>
                        <p class="text-xs text-gray-500">Professeur de Français</p>
                    </div>
                </div>
            </div>

            <!-- Navigation Menu -->
            <nav class="mt-8 flex-1">
                <div class="px-3 space-y-1">
                    <a href="dashboard.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                        <i data-feather="layout" class="mr-3 w-5 h-5"></i>
                        Tableau de bord
                    </a>
                    <a href="eleve.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                        <i data-feather="users" class="mr-3 w-5 h-5"></i>
                        Mes élèves
                    </a>
                    <a href="upload.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                        <i data-feather="upload" class="mr-3 w-5 h-5"></i>
                        Analyser une copie
                    </a>
                    <a href="rapport.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                        <i data-feather="file-text" class="mr-3 w-5 h-5"></i>
                        Rapports
                    </a>
                    <a href="comparaison.html" class="bg-blue-50 text-blue-700 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                        <i data-feather="bar-chart-2" class="mr-3 w-5 h-5"></i>
                        Statistiques
                    </a>
                    <a href="prevision.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                        <i data-feather="trending-up" class="mr-3 w-5 h-5"></i>
                        Prévisions IA
                    </a>
                </div>
                
                <!-- Divider -->
                <div class="mt-8 pt-6 border-t border-gray-200 px-3">
                    <div class="space-y-1">
                        <a href="fiches.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                            <i data-feather="bookmark" class="mr-3 w-5 h-5"></i>
                            Fiches de révision
                        </a>
                        <a href="exercices.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                            <i data-feather="edit-3" class="mr-3 w-5 h-5"></i>
                            Exercices générés
                        </a>
                        <a href="parents.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                            <i data-feather="mail" class="mr-3 w-5 h-5"></i>
                            Rapports parents
                        </a>
                    </div>
                </div>

                <!-- Bottom Section -->
                <div class="mt-auto pb-4 px-3">
                    <div class="space-y-1">
                        <a href="ethique.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                            <i data-feather="shield" class="mr-3 w-5 h-5"></i>
                            Éthique & RGPD
                        </a>
                        <a href="roadmap.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                            <i data-feather="map" class="mr-3 w-5 h-5"></i>
                            Roadmap
                        </a>
                        <a href="index.html" class="text-gray-700 hover:bg-gray-50 group flex items-center px-3 py-2 text-sm font-medium rounded-lg">
                            <i data-feather="home" class="mr-3 w-5 h-5"></i>
                            Retour accueil
                        </a>
                    </div>
                </div>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <div class="flex-1 overflow-auto">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b border-gray-200">
            <div class="px-6 py-4">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Comparaison anonymisée</h1>
                        <div class="mt-2 flex items-center space-x-4">
                            <div class="flex items-center">
                                <i data-feather="user" class="w-4 h-4 mr-2 text-gray-500"></i>
                                <span class="text-sm text-gray-600">Élève sélectionné :</span>
                            </div>
                            <select class="ml-2 px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option selected>Lucas Dubois</option>
                                <option>Sarah Martin</option>
                                <option>Thomas Caron</option>
                                <option>Emma Blanchard</option>
                                <option>Pierre Durand</option>
                                <option>Marie Rousseau</option>
                                <option>Antoine Moreau</option>
                                <option>Léa Petit</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-4 lg:mt-0">
                        <button onclick="window.print()" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 mr-3">
                            <i data-feather="printer" class="w-4 h-4 mr-2"></i>
                            Imprimer
                        </button>
                        <button onclick="exportData()" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                            <i data-feather="download" class="w-4 h-4 mr-2"></i>
                            Exporter CSV
                        </button>
                    </div>
                </div>
                
                <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <p class="text-sm text-blue-800">
                        <i data-feather="info" class="w-4 h-4 inline mr-2"></i>
                        Cette page vous permet de visualiser la position d'un élève par rapport à l'ensemble de la classe, sans afficher les noms des autres.
                    </p>
                </div>
            </div>
        </header>

        <!-- Filters -->
        <div class="px-6 py-4 bg-white border-b border-gray-200">
            <div class="flex flex-wrap items-center gap-4">
                <div class="flex items-center space-x-2">
                    <label class="text-sm font-medium text-gray-700">Matière :</label>
                    <select class="px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option selected>Français</option>
                        <option>Mathématiques</option>
                        <option>Histoire</option>
                        <option>Géographie</option>
                        <option>SVT</option>
                    </select>
                </div>
                
                <div class="flex items-center space-x-2">
                    <label class="text-sm font-medium text-gray-700">Niveau :</label>
                    <select class="px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>5e</option>
                        <option selected>4e</option>
                        <option>3e</option>
                    </select>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="current-period" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                    <label for="current-period" class="ml-2 text-sm text-gray-700">Afficher uniquement les données de la période en cours</label>
                </div>
            </div>
        </div>

        <!-- Content -->
        <div class="p-6">
            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Radar Chart -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">Analyse comparative par compétence</h3>
                        <p class="text-sm text-gray-600 mb-6">Comparaison entre Lucas et la moyenne de la classe</p>
                        <div class="chart-container">
                            <canvas id="radarChart"></canvas>
                        </div>
                        <div class="mt-4 flex items-center justify-center space-x-6">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-600">Lucas Dubois</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-gray-400 rounded-full mr-2"></div>
                                <span class="text-sm text-gray-600">Moyenne de la classe</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bar Chart -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">Position dans la classe</h3>
                        <p class="text-sm text-gray-600 mb-6">Moyenne des 5 derniers devoirs (élèves anonymisés)</p>
                        <div class="chart-container">
                            <canvas id="barChart"></canvas>
                        </div>
                        <div class="mt-4 text-center">
                            <span class="text-sm text-gray-600">Lucas se situe au 
                                <span class="font-semibold text-blue-600">8e rang</span> sur 28 élèves
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">Note moyenne</p>
                            <p class="text-2xl font-bold text-gray-900">13.8/20</p>
                        </div>
                        <div class="p-3 bg-blue-100 rounded-full">
                            <i data-feather="trending-up" class="w-6 h-6 text-blue-600"></i>
                        </div>
                    </div>
                    <p class="mt-2 text-sm text-gray-600">+1.2 points vs moyenne classe (12.6)</p>
                </div>

                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">Progression</p>
                            <p class="text-2xl font-bold text-green-600">+0.8</p>
                        </div>
                        <div class="p-3 bg-green-100 rounded-full">
                            <i data-feather="arrow-up" class="w-6 h-6 text-green-600"></i>
                        </div>
                    </div>
                    <p class="mt-2 text-sm text-gray-600">Points gagnés vs trimestre précédent</p>
                </div>

                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">Force principale</p>
                            <p class="text-2xl font-bold text-purple-600">Vocabulaire</p>
                        </div>
                        <div class="p-3 bg-purple-100 rounded-full">
                            <i data-feather="star" class="w-6 h-6 text-purple-600"></i>
                        </div>
                    </div>
                    <p class="mt-2 text-sm text-gray-600">16.2/20 (classe : 13.1/20)</p>
                </div>
            </div>

            <!-- Pedagogical Block -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-8">
                <div class="p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                        <i data-feather="book" class="w-5 h-5 mr-2 text-blue-600"></i>
                        Comment interpréter ces données ?
                    </h3>
                    <div class="prose text-gray-700">
                        <p class="mb-4">
                            Les comparaisons sont là pour identifier les forces et les axes de progression. 
                            L'objectif n'est pas de classer, mais de mieux accompagner chaque élève.
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                            <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                                <h4 class="font-semibold text-green-800 mb-2">
                                    <i data-feather="check-circle" class="w-4 h-4 inline mr-1"></i>
                                    Points forts de Lucas
                                </h4>
                                <ul class="text-sm text-green-700 space-y-1">
                                    <li>• Vocabulaire riche et varié</li>
                                    <li>• Progression constante (+0.8 pts)</li>
                                    <li>• Au-dessus de la moyenne classe</li>
                                    <li>• Structure narrative cohérente</li>
                                </ul>
                            </div>
                            <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                                <h4 class="font-semibold text-blue-800 mb-2">
                                    <i data-feather="target" class="w-4 h-4 inline mr-1"></i>
                                    Axes d'amélioration
                                </h4>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li>• Renforcer la conjugaison</li>
                                    <li>• Améliorer l'orthographe</li>
                                    <li>• Travailler les accords</li>
                                    <li>• Développer l'argumentation</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Actions recommandées</h3>
                    <div class="flex flex-wrap gap-3">
                        <button onclick="createTargetedSheet()" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            <i data-feather="file-plus" class="w-4 h-4 mr-2"></i>
                            Créer une fiche ciblée pour Lucas
                        </button>
                        <button onclick="generateExercises()" class="inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                            <i data-feather="edit-3" class="w-4 h-4 mr-2"></i>
                            Générer des exercices personnalisés
                        </button>
                        <button onclick="scheduleFollowUp()" class="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            <i data-feather="calendar" class="w-4 h-4 mr-2"></i>
                            Programmer un suivi
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // Initialize Feather icons
        feather.replace();

        // Radar Chart
        const radarCtx = document.getElementById('radarChart').getContext('2d');
        new Chart(radarCtx, {
            type: 'radar',
            data: {
                labels: ['Orthographe', 'Grammaire', 'Vocabulaire', 'Structure', 'Conjugaison'],
                datasets: [{
                    label: 'Lucas Dubois',
                    data: [12, 14, 16, 15, 11],
                    borderColor: 'rgb(59, 130, 246)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    pointBackgroundColor: 'rgb(59, 130, 246)',
                    pointBorderColor: 'rgb(59, 130, 246)',
                    pointHoverBackgroundColor: 'rgb(59, 130, 246)',
                    pointHoverBorderColor: 'rgb(59, 130, 246)'
                }, {
                    label: 'Moyenne classe',
                    data: [13, 12, 13, 13, 12],
                    borderColor: 'rgb(156, 163, 175)',
                    backgroundColor: 'rgba(156, 163, 175, 0.1)',
                    pointBackgroundColor: 'rgb(156, 163, 175)',
                    pointBorderColor: 'rgb(156, 163, 175)',
                    pointHoverBackgroundColor: 'rgb(156, 163, 175)',
                    pointHoverBorderColor: 'rgb(156, 163, 175)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 20,
                        ticks: {
                            stepSize: 5
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });

        // Bar Chart
        const barCtx = document.getElementById('barChart').getContext('2d');
        new Chart(barCtx, {
            type: 'bar',
            data: {
                labels: ['Élève A', 'Élève B', 'Élève C', 'Élève D', 'Élève E', 'Élève F', 'Élève G', 'Lucas', 'Élève H', 'Élève I', 'Élève J', 'Élève K', 'Élève L', 'Élève M'],
                datasets: [{
                    label: 'Note moyenne',
                    data: [17.2, 16.8, 16.1, 15.9, 15.3, 14.7, 14.2, 13.8, 13.5, 13.1, 12.8, 12.3, 11.9, 11.2],
                    backgroundColor: function(context) {
                        return context.dataIndex === 7 ? 'rgba(59, 130, 246, 0.8)' : 'rgba(156, 163, 175, 0.6)';
                    },
                    borderColor: function(context) {
                        return context.dataIndex === 7 ? 'rgb(59, 130, 246)' : 'rgb(156, 163, 175)';
                    },
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 20,
                        ticks: {
                            stepSize: 5
                        }
                    }
                }
            }
        });

        // Functions
        function exportData() {
            // Simulate CSV export
            const csvData = "Élève,Note Moyenne,Orthographe,Grammaire,Vocabulaire,Structure,Conjugaison\nLucas Dubois,13.8,12,14,16,15,11\nMoyenne classe,12.6,13,12,13,13,12";
            const blob = new Blob([csvData], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'comparaison_lucas_dubois.csv';
            a.click();
            window.URL.revokeObjectURL(url);
            
            // Show notification
            showNotification('Données exportées avec succès !', 'success');
        }

        function createTargetedSheet() {
            showNotification('Génération de la fiche ciblée en cours...', 'info');
            setTimeout(() => {
                showNotification('Fiche ciblée créée avec succès ! Consultez la section "Fiches de révision".', 'success');
            }, 2000);
        }

        function generateExercises() {
            showNotification('Génération d\'exercices personnalisés en cours...', 'info');
            setTimeout(() => {
                showNotification('Exercices personnalisés générés ! Consultez la section "Exercices ciblés".', 'success');
            }, 2000);
        }

        function scheduleFollowUp() {
            showNotification('Suivi programmé avec succès ! Prochaine évaluation dans 2 semaines.', 'success');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm ${
                type === 'success' ? 'bg-green-600 text-white' :
                type === 'error' ? 'bg-red-600 text-white' :
                'bg-blue-600 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i data-feather="${type === 'success' ? 'check-circle' : type === 'error' ? 'alert-circle' : 'info'}" class="w-5 h-5 mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            feather.replace();
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }
    </script>
</body>
</html> 